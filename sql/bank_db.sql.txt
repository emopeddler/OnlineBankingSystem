CREATE DATABASE IF NOT EXISTS bank_db;
USE bank_db;

CREATE TABLE IF NOT EXISTS Customer (
    customer_id INT AUTO_INCREMENT PRIMARY KEY,
    first_name VARCHAR(100) NOT NULL,
    last_name VARCHAR(100),
    username VARCHAR(100) NOT NULL UNIQUE,
    password_hash VARCHAR(255) NOT NULL,
    phone VARCHAR(20)
);

CREATE TABLE IF NOT EXISTS Account (
    account_number BIGINT PRIMARY KEY,
    customer_id INT NOT NULL,
    account_type VARCHAR(50) NOT NULL,
    balance DOUBLE NOT NULL DEFAULT 0,
    FOREIGN KEY (customer_id) REFERENCES Customer(customer_id) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS `Transaction` (
    transaction_id BIGINT AUTO_INCREMENT PRIMARY KEY,
    account_number BIGINT NOT NULL,
    type VARCHAR(100) NOT NULL,
    amount DOUBLE NOT NULL,
    transaction_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (account_number) REFERENCES Account(account_number) ON DELETE CASCADE
);

INSERT INTO Customer (first_name, last_name, username, password_hash, phone)
VALUES ('Test', 'User', 'testuser', 'testpass', '9999999999');

INSERT INTO Account (account_number, customer_id, account_type, balance)
VALUES (1000000001, 1, 'Savings', 5420.75);

INSERT INTO `Transaction` (account_number, type, amount)
VALUES (1000000001, 'Opening Balance', 5420.75);
